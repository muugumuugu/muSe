function preload(){clusters=loadJSON("../dat/clusters.json"),names=loadStrings("../dat/tiles/tile_names.txt")}let player,pl=[];function setup(){player=select("audio"),player.elt.onended=function(){player.play()},noCanvas(),keys=Object.keys(clusters),i=0;for(let e of keys){if(div=createDiv(""),div.id("d"+e),div.parent(select("main")),img=createImg("../dat/tiles/frames/"+e.replace("/","")+".webp",e),img.elt.id="i"+e,img.elt.title=names[i],img.elt.style.cursor="pointer",img.elt.onclick=function(){mkpl(event)},img.parent(div),i++,"*"==clusters[e][0])continue;let t=createSelect();t.parent(div),t.elt.id="s"+e,t.elt.onchange=function(){player.elt.src=t.value()};for(let l of clusters[e])t.option(l,l.replace(/(.*?)_/,"../music/$1/")+".mp3")}}function mkpl(e){pl=[];let t=document.getElementById(e.target.id.replace("i","s"));if(!t)return;let l=t.id.replace("/","").replace("s",""),i=t.children;for(let e of i)pl.push('"'+encodeURI(e.value)+'"');loc=window.location.href.replace(/html\/.*/,""),window.location.href=loc+'html/playlist_simple.html?playlist={"dat":['+pl+"]}&title="+names[parseInt(l)]+"&cover=../dat/tiles/frames/"+l+".webp"}function keyPressed(){if (key==" " ){player.play();}}